name: Autotest CI

on:
  push:
    branches: [main]
  pull_request:

jobs:
  autotest:
    runs-on: ubuntu-latest      # 云端分配Ubuntu服务器

    steps:
      - uses: actions/checkout@v4   # 拉取主仓库代码（包括 autotest 目录）

      # 如有子模块也自动拉取
      - name: Checkout submodules
        run: git submodule update --init --recursive

      # 安装 Python 依赖
      - name: Install dependencies
        run: |
          cd autotest
          pip install -r requirements.txt

      # 运行自动测试
      - name: Run autotest
        run: |
          cd autotest
          pytest
